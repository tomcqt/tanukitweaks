{"version":3,"sources":["webpack:///./app/javascript/mastodon/components/admin/Dimension.jsx"],"names":["Dimension","PureComponent","constructor","arguments","state","loading","data","componentDidMount","start_at","end_at","dimension","limit","params","this","props","api","post","keys","then","res","setState","catch","err","console","error","render","label","content","_jsx","Array","from","map","_","i","className","Skeleton","width","sum","reduce","cur","value","item","key","roundTo10","title","human_key","human_value","FormattedNumber"],"mappings":"4LASe,MAAMA,UAAkBC,gBAAcC,cAAA,SAAAC,WAAA,KAWnDC,MAAQ,CACNC,SAAS,EACTC,KAAM,KACN,CAEFC,oBACE,MAAM,SAAEC,EAAQ,OAAEC,EAAM,UAAEC,EAAS,MAAEC,EAAK,OAAEC,GAAWC,KAAKC,MAE5DC,cAAMC,KAAK,2BAA4B,CAAEC,KAAM,CAACP,GAAYF,WAAUC,SAAQE,QAAO,CAACD,GAAYE,IAAUM,MAAKC,IAC/GN,KAAKO,SAAS,CACZf,SAAS,EACTC,KAAMa,EAAIb,MACV,IACDe,OAAMC,IACPC,QAAQC,MAAMF,EAAI,GAEtB,CAEAG,SACE,MAAM,MAAEC,EAAK,MAAEf,GAAUE,KAAKC,OACxB,QAAET,EAAO,KAAEC,GAASO,KAAKT,MAE/B,IAAIuB,EAEJ,GAAItB,EACFsB,EACEC,YAAA,kBACEA,YAAA,kBACGC,MAAMC,KAAKD,MAAMlB,IAAQoB,KAAI,CAACC,EAAGC,IAChCL,YAAA,MAAIM,UAAU,mBAAuBD,EACnCL,YAAA,MAAIM,UAAU,6BAAsB,EAClCN,YAACO,IAAQ,CAACC,MAAO,OAGnBR,YAAA,MAAIM,UAAU,+BAAwB,EACpCN,YAACO,IAAQ,CAACC,MAAO,eAOxB,CACL,MAAMC,EAAM/B,EAAK,GAAGA,KAAKgC,QAAO,CAACD,EAAKE,IAAQF,EAAmB,EAAZE,EAAIC,OAAY,GAErEb,EACEC,YAAA,kBACEA,YAAA,kBACGtB,EAAK,GAAGA,KAAKyB,KAAIU,GAChBb,YAAA,MAAIM,UAAU,mBAAuBO,EAAKC,IACxCd,YAAA,MAAIM,UAAU,6BAAsB,EAClCN,YAAA,QAAMM,UAAY,0DAAyDS,YAAyB,EAAbF,EAAKD,MAAaH,EAAO,SAChHT,YAAA,QAAMgB,MAAOH,EAAKC,UAAI,EAAED,EAAKI,YAG/BjB,YAAA,MAAIM,UAAU,+BAAwB,OACP,IAArBO,EAAKK,YAA8BL,EAAKK,YAAclB,YAACmB,IAAe,CAACP,MAAOC,EAAKD,aAOzG,CAEA,OACEZ,YAAA,OAAKM,UAAU,kBAAW,EACxBN,YAAA,eAAKF,GAEJC,EAGP,E","file":"js/432-55e5f3bad10e672dde8a.chunk.js","sourcesContent":["import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { FormattedNumber } from 'react-intl';\n\nimport api from 'mastodon/api';\nimport { Skeleton } from 'mastodon/components/skeleton';\nimport { roundTo10 } from 'mastodon/utils/numbers';\n\nexport default class Dimension extends PureComponent {\n\n  static propTypes = {\n    dimension: PropTypes.string.isRequired,\n    start_at: PropTypes.string.isRequired,\n    end_at: PropTypes.string.isRequired,\n    limit: PropTypes.number.isRequired,\n    label: PropTypes.string.isRequired,\n    params: PropTypes.object,\n  };\n\n  state = {\n    loading: true,\n    data: null,\n  };\n\n  componentDidMount () {\n    const { start_at, end_at, dimension, limit, params } = this.props;\n\n    api().post('/api/v1/admin/dimensions', { keys: [dimension], start_at, end_at, limit, [dimension]: params }).then(res => {\n      this.setState({\n        loading: false,\n        data: res.data,\n      });\n    }).catch(err => {\n      console.error(err);\n    });\n  }\n\n  render () {\n    const { label, limit } = this.props;\n    const { loading, data } = this.state;\n\n    let content;\n\n    if (loading) {\n      content = (\n        <table>\n          <tbody>\n            {Array.from(Array(limit)).map((_, i) => (\n              <tr className='dimension__item' key={i}>\n                <td className='dimension__item__key'>\n                  <Skeleton width={100} />\n                </td>\n\n                <td className='dimension__item__value'>\n                  <Skeleton width={60} />\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n    } else {\n      const sum = data[0].data.reduce((sum, cur) => sum + (cur.value * 1), 0);\n\n      content = (\n        <table>\n          <tbody>\n            {data[0].data.map(item => (\n              <tr className='dimension__item' key={item.key}>\n                <td className='dimension__item__key'>\n                  <span className={`dimension__item__indicator dimension__item__indicator--${roundTo10(((item.value * 1) / sum) * 100)}`} />\n                  <span title={item.key}>{item.human_key}</span>\n                </td>\n\n                <td className='dimension__item__value'>\n                  {typeof item.human_value !== 'undefined' ? item.human_value : <FormattedNumber value={item.value} />}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n    }\n\n    return (\n      <div className='dimension'>\n        <h4>{label}</h4>\n\n        {content}\n      </div>\n    );\n  }\n\n}\n"],"sourceRoot":""}